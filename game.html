<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—¥æœ¬è¡ŒéŠæˆ²æŒ‘æˆ° - 2026</title>
    <style>
        :root { --primary: #76c7ff; --bg: #f7f9fc; --accent: #ffcb05; }
        body { font-family: "PingFang TC", sans-serif; background: var(--bg); margin: 0; text-align: center; }
        header { background: white; padding: 15px 20px; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .back-btn { margin-right: 15px; cursor: pointer; }
        
        /* ä½¿ç”¨è€…é¸æ“‡ä»‹é¢ */
        #user-selector { 
            position: fixed; inset: 0; background: white; z-index: 5000; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;
        }
        .user-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 30px; }
        .user-btn { 
            width: 80px; height: 80px; border-radius: 50%; border: 3px solid #eee;
            background: white; font-size: 20px; font-weight: bold; cursor: pointer;
            transition: 0.2s; display: flex; align-items: center; justify-content: center;
        }
        .user-btn:active { transform: scale(0.9); border-color: var(--primary); color: var(--primary); }

        /* éŠæˆ²å€åŸŸ */
        .game-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; background: #fff; margin-bottom: 10px; }
        .player-info { font-weight: bold; color: var(--primary); }
        
        .game-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; padding: 10px; max-width: 400px; margin: auto; }
        .card { aspect-ratio: 1/1; perspective: 1000px; cursor: pointer; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.5s; transform-style: preserve-3d; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border-radius: 12px; }
        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 28px; }
        .card-front { background: #fff; color: #ddd; }
        .card-back { background: #fff; transform: rotateY(180deg); }
        .card.matched .card-inner { border: 3px solid #55efc4; opacity: 0.6; }

        /* æ’è¡Œæ¦œ */
        #leaderboard { margin-top: 20px; padding: 20px; background: white; border-radius: 20px; width: 80%; margin-inline: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
        .rank-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f9f9f9; font-size: 14px; }
        .rank-name { font-weight: bold; }
        .rank-score { color: #888; }
    </style>
</head>
<body>

<div id="user-selector">
    <h2>ğŸ† èª°è¦æŒ‘æˆ°ï¼Ÿ</h2>
    <div class="user-grid">
        <div class="user-btn" onclick="startGame('èŠŠ')">èŠŠ</div>
        <div class="user-btn" onclick="startGame('è¾°')">è¾°</div>
        <div class="user-btn" onclick="startGame('èˆª')">èˆª</div>
        <div class="user-btn" onclick="startGame('å®‰')">å®‰</div>
        <div class="user-btn" onclick="startGame('é¦™')">é¦™</div>
        <div class="user-btn" onclick="startGame('ç‘©')">ç‘©</div>
        <div class="user-btn" onclick="startGame('å»·')">å»·</div>
    </div>
</div>

<header>
    <div class="back-btn" onclick="location.href='index.html'"><svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="#76c7ff" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></div>
    <b style="font-size: 18px;">ğŸ® è¨˜æ†¶å¤§è€ƒé©—</b>
</header>

<div class="game-header">
    <div class="player-info">ç©å®¶: <span id="current-player">---</span></div>
    <div>â±ï¸ <span id="timer">0</span>s</div>
</div>

<div class="game-grid" id="grid"></div>

<div id="leaderboard">
    <h3 style="font-size: 15px; color: #aaa;">ğŸ–ï¸ å®¶æ—æ¦®è­½æ¦œ (æœ€çŸ­ç§’æ•¸)</h3>
    <div id="rank-list"></div>
</div>

<button onclick="location.reload()" style="margin: 20px; padding: 12px 30px; border-radius: 20px; border: none; background: #eee; color: #888; font-weight: bold;">æ›äººç© ğŸ”„</button>

<script>
    const emojis = ['ğŸ¿', 'â„ï¸', 'â›„', 'ğŸ£', 'ğŸ—¼', 'ğŸ›ï¸', 'ğŸœ', 'ğŸšƒ'];
    let currentPlayer = "";
    let cards = [...emojis, ...emojis];
    let flippedCards = [];
    let matchedPairs = 0;
    let seconds = 0;
    let timerInterval;

    // å•Ÿå‹•éŠæˆ²
    function startGame(name) {
        currentPlayer = name;
        document.getElementById('current-player').innerText = name;
        document.getElementById('user-selector').style.display = 'none';
        initGrid();
        startTimer();
        updateLeaderboard();
    }

    function initGrid() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        cards.sort(() => Math.random() - 0.5);
        cards.forEach(emoji => {
            const el = document.createElement('div');
            el.className = 'card';
            el.dataset.emoji = emoji;
            el.innerHTML = `<div class="card-inner"><div class="card-front">?</div><div class="card-back">${emoji}</div></div>`;
            el.onclick = () => flip(el);
            grid.appendChild(el);
        });
    }

    function flip(el) {
        if (flippedCards.length === 2 || el.classList.contains('flipped') || el.classList.contains('matched')) return;
        el.classList.add('flipped');
        flippedCards.push(el);
        if (flippedCards.length === 2) check();
    }

    function check() {
        const [c1, c2] = flippedCards;
        if (c1.dataset.emoji === c2.dataset.emoji) {
            c1.classList.add('matched'); c2.classList.add('matched');
            matchedPairs++;
            flippedCards = [];
            if (matchedPairs === emojis.length) win();
        } else {
            setTimeout(() => { c1.classList.remove('flipped'); c2.classList.remove('flipped'); flippedCards = []; }, 800);
        }
    }

    function startTimer() {
        timerInterval = setInterval(() => { seconds++; document.getElementById('timer').innerText = seconds; }, 1000);
    }

    function win() {
        clearInterval(timerInterval);
        saveScore(currentPlayer, seconds);
        setTimeout(() => {
            alert(`ğŸ‰ ${currentPlayer} æŒ‘æˆ°æˆåŠŸï¼\nè€—æ™‚ï¼š${seconds} ç§’`);
            updateLeaderboard();
        }, 500);
    }

    // æ’è¡Œæ¦œé‚è¼¯ (ä½¿ç”¨ localStorage å­˜å„²æ–¼æ‰‹æ©Ÿæœ¬åœ°)
    function saveScore(name, score) {
        let scores = JSON.parse(localStorage.getItem('gameScores') || '{}');
        // å¦‚æœé€™å€‹äººé‚„æ²’ç©éï¼Œæˆ–è€…é€™æ¬¡æˆç¸¾æ›´å¥½ï¼Œå‰‡æ›´æ–°
        if (!scores[name] || score < scores[name]) {
            scores[name] = score;
            localStorage.setItem('gameScores', JSON.stringify(scores));
        }
    }

    function updateLeaderboard() {
        let scores = JSON.parse(localStorage.getItem('gameScores') || '{}');
        let sorted = Object.entries(scores).sort((a, b) => a[1] - b[1]);
        const list = document.getElementById('rank-list');
        list.innerHTML = sorted.map(([name, time], index) => `
            <div class="rank-item">
                <span class="rank-name">${index + 1}. ${name}</span>
                <span class="rank-score">${time}s</span>
            </div>
        `).join('') || '<div style="color:#eee">å°šç„¡ç´€éŒ„</div>';
    }

    updateLeaderboard();
</script>
</body>
</html>
